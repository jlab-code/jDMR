})
f[[1]]
f[[1]][4]
f[1]
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
f[[1]]
extractREGIONS <- lapply(f, function(x){
cl <- x[,c("cluster.length")]
#cl <- cbind(cl, context=x)
cl$cluster.length <-as.numeric(cl$cluster.length)
cl <- data.frame(cl)
})
f[[1]]
f[[1]]$cluster.length
f[[1]][4]
extractREGIONS <- lapply(f, function(x){
cl <- x$cluster.length
#cl <- cbind(cl, context=x)
#cl$cluster.length <-as.numeric(cl$cluster.length)
#cl <- data.frame(cl)
})
cl
extractREGIONS
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
context <- c("min.C.5","min.C.4","min.C.3")
extractREGIONS <- lapply(f, function(x){
cl <- x$cluster.length
cl <- cbind(cl, min=x)
#cl$cluster.length <-as.numeric(cl$cluster.length)
cl <- data.frame(cl)
})
extractREGIONS
f
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
a$min <- "min.C_5"
a
a$reg.obs$min <- "min.C_5"
a
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
a$reg.obs$min <- "min.C_5"
b$reg.obs$min <- "min.C_4"
c$reg.obs$min <- "min.C_3"
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
f
#pdf("/Users/rashmi/Desktop/MA_lines/test_jDMR/makeREGIONS_allContext.pdf", width=8, height=5)
mydf <- rbindlist(f)
mmydf
mydf
mydf <- mydf[,c("cluster.length", "min")]
mydf
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=context), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
#scale_x_log10(breaks = scales::log_breaks(n = 7)) +
#labs(x="log10 (region length)")
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1.5))
print(p)
library(ggplot2)
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=context), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
#scale_x_log10(breaks = scales::log_breaks(n = 7)) +
#labs(x="log10 (region length)")
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1.5))
print(p)
bw=0.8
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05)
#geom_density(aes(y = ..density.., colour=context), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
#scale_x_log10(breaks = scales::log_breaks(n = 7)) +
#labs(x="log10 (region length)")
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1.5))
print(p)
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0))
print(p)
bw=0.01
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05)
#geom_density(aes(y = ..density.., colour=context), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
#scale_x_log10(breaks = scales::log_breaks(n = 7)) +
#labs(x="log10 (region length)")
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0))
print(p)
bw=10
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05)
#geom_density(aes(y = ..density.., colour=context), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
#scale_x_log10(breaks = scales::log_breaks(n = 7)) +
#labs(x="log10 (region length)")
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0))
print(p)
bw=1
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=context), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7)) +
#labs(x="log10 (region length)")
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0))
print(p)
bw=1
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=context), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
#labs(x="log10 (region length)")
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0))
print(p)
bw=0.01
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=context), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
#labs(x="log10 (region length)")
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0))
print(p)
bw=0.05
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=context), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
#labs(x="log10 (region length)")
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0))
print(p)
p <- gg +
#scale_fill_manual(values=c("darkgoldenrod", "#666666")) +
#scale_color_manual(values=c("darkgoldenrod","#666666")) +
#scale_linetype_manual(values=c("solid", "dashed")) +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 7))
print(p)
rm(list=ls())
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
a$reg.obs$min <- "min.C_5"
b$reg.obs$min <- "min.C_4"
c$reg.obs$min <- "min.C_3"
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
bw=0.05
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
geom_density(aes(y = ..density.., colour=context), adjust=5,
alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
labs(x="log10 (cluster length)")
p <- gg +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 7))
print(p)
rm(list=ls())
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
a$reg.obs$min <- "min.C_5"
b$reg.obs$min <- "min.C_4"
c$reg.obs$min <- "min.C_3"
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
bw=0.05
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
geom_density(aes(y = ..density.., colour=min), adjust=5,
alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
labs(x="log10 (cluster length)")
p <- gg +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 7))
print(p)
rm(list=ls())
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
a$reg.obs$min <- "min.C_5"
b$reg.obs$min <- "min.C_4"
c$reg.obs$min <- "min.C_3"
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
bw=0.05
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=min), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
labs(x="log10 (cluster length)")
p <- gg +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 7))
print(p)
rm(list=ls())
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
a$reg.obs$min <- "min.C_5"
b$reg.obs$min <- "min.C_4"
c$reg.obs$min <- "min.C_3"
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
bw=0.01
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=min), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
labs(x="log10 (cluster length)")
p <- gg +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 7))
print(p)
rm(list=ls())
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
a$reg.obs$min <- "min.C_5"
b$reg.obs$min <- "min.C_4"
c$reg.obs$min <- "min.C_3"
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
bw=0.02
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=min), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
labs(x="log10 (cluster length)")
p <- gg +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 7))
print(p)
rm(list=ls())
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
a$reg.obs$min <- "min.C_5"
b$reg.obs$min <- "min.C_4"
c$reg.obs$min <- "min.C_3"
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
bw=0.03
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=min), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
labs(x="log10 (cluster length)")
p <- gg +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 7))
print(p)
rm(list=ls())
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
a$reg.obs$min <- "min.C_5"
b$reg.obs$min <- "min.C_4"
c$reg.obs$min <- "min.C_3"
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
bw=0.04
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=min), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
labs(x="log10 (cluster length)")
p <- gg +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 7))
print(p)
rm(list=ls())
a <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_5/Arabidopsis_regions_chr1_CG.Rdata")
b <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_4/Arabidopsis_regions_chr1_CG.Rdata")
c <- dget("/Users/rashmi/basedir/DMRcaller/PRODUCED/min.C_3/Arabidopsis_regions_chr1_CG.Rdata")
a$reg.obs$min <- "min.C_5"
b$reg.obs$min <- "min.C_4"
c$reg.obs$min <- "min.C_3"
f <- list(a$reg.obs,
b$reg.obs,
c$reg.obs)
bw=0.05
mydf <- rbindlist(f)
mydf <- mydf[,c("cluster.length", "min")]
gg <- ggplot(mydf, aes(x=cluster.length, fill=min)) +
geom_histogram(aes(y = ..density..), binwidth=bw, colour="black",
alpha=0.5, position="identity", size=0.05) +
#geom_density(aes(y = ..density.., colour=min), adjust=5,
#             alpha = 0.4, position = "identity", size=0.7) +
scale_x_log10(breaks = scales::log_breaks(n = 7))
labs(x="log10 (cluster length)")
p <- gg +
theme(strip.background = element_rect(colour = "black", fill="grey"),
panel.border = element_rect(fill = NA),
panel.background=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank()) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 7))
print(p)
